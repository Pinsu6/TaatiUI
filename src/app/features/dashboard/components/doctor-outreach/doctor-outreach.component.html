<!-- src/app/features/dashboard/components/doctor-outreach/doctor-outreach.component.html -->
<!-- Adapted from provided HTML: Removed custom header/footer, added Angular bindings, enhanced with sorting and actions -->
<div class="mx-auto">
  <!-- Filters -->
  <div class="flex flex-col sm:flex-row justify-between items-center gap-4 mb-6">
    <!-- Search -->
    <div class="relative w-full sm:w-1/2">
      <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="applyFilters()" placeholder="Search doctor..." 
        class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-tati-burgundy outline-none">
      <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
    </div>

    <!-- Specialization Filter -->
    <select [(ngModel)]="selectedSpecialization" (ngModelChange)="applyFilters()" class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-tati-burgundy outline-none">
      <option value="all">All Specializations</option>
      <option value="general physician">General Physician</option>
      <option value="pediatrician">Pediatrician</option>
      <option value="cardiologist">Cardiologist</option>
    </select>
  </div>

  <!-- Doctor Table -->
  <div class="overflow-x-auto bg-white shadow-lg rounded-xl border mb-10">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-tati-burgundy text-white">
        <tr>
          <th class="px-6 py-3 text-left text-sm font-semibold cursor-pointer" (click)="sortBy('name')">Doctor Name <i class="fas fa-sort ml-1" *ngIf="sortColumn === 'name' && sortDirection === 'asc'"></i><i class="fas fa-sort-down ml-1" *ngIf="sortColumn === 'name' && sortDirection === 'desc'"></i></th>
          <th class="px-6 py-3 text-left text-sm font-semibold cursor-pointer" (click)="sortBy('specialization')">Specialization <i class="fas fa-sort ml-1" *ngIf="sortColumn === 'specialization' && sortDirection === 'asc'"></i><i class="fas fa-sort-down ml-1" *ngIf="sortColumn === 'specialization' && sortDirection === 'desc'"></i></th>
          <th class="px-6 py-3 text-left text-sm font-semibold cursor-pointer" (click)="sortBy('contact')">Contact <i class="fas fa-sort ml-1" *ngIf="sortColumn === 'contact' && sortDirection === 'asc'"></i><i class="fas fa-sort-down ml-1" *ngIf="sortColumn === 'contact' && sortDirection === 'desc'"></i></th>
          <th class="px-6 py-3 text-left text-sm font-semibold cursor-pointer" (click)="sortBy('totalOrders')">Total Orders <i class="fas fa-sort ml-1" *ngIf="sortColumn === 'totalOrders' && sortDirection === 'asc'"></i><i class="fas fa-sort-down ml-1" *ngIf="sortColumn === 'totalOrders' && sortDirection === 'desc'"></i></th>
          <th class="px-6 py-3 text-left text-sm font-semibold cursor-pointer" (click)="sortBy('lastOrder')">Last Order <i class="fas fa-sort ml-1" *ngIf="sortColumn === 'lastOrder' && sortDirection === 'asc'"></i><i class="fas fa-sort-down ml-1" *ngIf="sortColumn === 'lastOrder' && sortDirection === 'desc'"></i></th>
          <th class="px-6 py-3 text-left text-sm font-semibold">Ordered Products</th>
          <th class="px-6 py-3 text-left text-sm font-semibold">Not Ordered</th>
          <th class="px-6 py-3 text-center text-sm font-semibold">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        <tr *ngFor="let d of filteredDoctors" class="hover:bg-gray-50">
          <td class="px-6 py-4 text-sm font-medium text-gray-800">{{d.name}}</td>
          <td class="px-6 py-4 text-sm text-gray-600">{{d.specialization}}</td>
          <td class="px-6 py-4 text-sm text-gray-600">{{d.contact}}</td>
          <td class="px-6 py-4 text-sm text-gray-600">{{d.totalOrders}}</td>
          <td class="px-6 py-4 text-sm text-gray-600">{{d.lastOrder}}</td>
          <td class="px-6 py-4 text-sm text-green-700">{{d.ordered}}</td>
          <td class="px-6 py-4 text-sm text-red-600">{{d.notOrdered}}</td>
          <td class="px-6 py-4 text-center flex gap-2 justify-center">
            <button (click)="sendWhatsApp(d)" class="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700"><i class="fab fa-whatsapp"></i></button>
            <button (click)="viewDetails(d)" class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"><i class="fas fa-eye"></i></button>
            <button (click)="sendCampaign(d)" class="px-3 py-1 bg-tati-burgundy text-white rounded hover:opacity-90"><i class="fas fa-paper-plane"></i></button>
          </td>
        </tr>
        <tr *ngIf="filteredDoctors.length === 0">
          <td colspan="8" class="px-6 py-4 text-center text-sm text-gray-500">No doctors found matching the criteria.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- AI Recommendations -->
  <div class="bg-white rounded-xl shadow border-t-4 border-tati-gold p-6">
    <h2 class="text-lg font-semibold text-tati-burgundy mb-4">
      <i class="fas fa-robot text-blue-500 mr-2"></i> AI Recommendations
    </h2>
    <p class="text-gray-600 mb-4">AI-based suggestions to improve engagement and sales based on doctor ordering patterns:</p>

    <div class="space-y-4">
      <div *ngFor="let d of filteredDoctors" class="p-4 bg-gray-50 border-l-4 border-blue-500 rounded">
        <h4 class="font-semibold text-tati-burgundy">{{d.name}}</h4>
        <p class="text-gray-700 text-sm mt-1">{{d.ai}}</p>
      </div>
      <div *ngIf="filteredDoctors.length === 0" class="p-4 bg-gray-50 text-center text-gray-500">
        No recommendations available based on current filters.
      </div>
    </div>
  </div>
</div>